==========================================
DistilBERT-XGBoost Risk Model Training
==========================================

Checking dependencies...
Starting model training...


======================================================================
SPRINTGUARD ML MODEL TRAINING
======================================================================
Architecture: Hybrid DistilBERT-XGBoost
======================================================================

[INIT] Initializing trainer...
Initializing feature extractors...
Using device: cuda
Loading distilbert-base-uncased...
✓ GPU detected - skipping quantization (using native CUDA)
✓ BertEmbedder ready (device=cuda (NVIDIA L4), max_length=None, cache_size=None)

======================================================================
[STAGE 4] Loading Training Data
======================================================================
Data source: data/neodataset_augmented_3class.csv
Confidence threshold: >0.5

[LOAD] Reading CSV file...
  ✓ Loaded 12106 stories
  ✓ Columns: 18

[VALIDATION] Checking required columns...
  ✓ All required columns present

[FILTER] Applying confidence threshold...
  Removed 214 low-confidence stories (1.8%)
  ✓ Retained 11892 high-confidence stories

[TEXT] Creating full_text column...
  ✓ Created full_text for 11892 stories

[LABELS] Mapping risk labels to integer classes...
  Mapping: {'Low': 0, 'Medium': 1, 'High': 2}
  Current risk_label values: ['High', 'Low', 'Medium']
  ✓ Label mapping successful (no NaN values)
  ✓ All 3 classes present: [0, 1, 2]

[CLASS DISTRIBUTION]
  Low (class 0): 7353 (61.8%)
  Medium (class 1): 345 (2.9%)
  High (class 2): 4194 (35.3%)

[IMBALANCE] Class imbalance ratio: 21.31:1
  ⚠ Warning: Significant class imbalance detected
    Using class weights for balanced training

✓ Data loading complete: 11892 stories ready for training

======================================================================
[SPLIT] Creating Train/Val/Test Splits
======================================================================
Strategy: Stratified by project (prevents data leakage)
Split ratio: 60% train, 20% val, 20% test

[SPLIT 1/2] Creating train and temp sets...
  Train: 7135 stories
  Temp (val+test): 4757 stories

[SPLIT 2/2] Splitting temp into val and test...
  Val:  2378 stories
  Test: 2379 stories

[SUMMARY] Final split sizes:
  Train: 7135 (60.0%)
  Val:   2378 (20.0%)
  Test:  2379 (20.0%)
  Total: 11892

[VALIDATION] Verifying stratification...
  Train class distribution:
    Low: 61.7%
    Medium: 2.8%
    High: 35.5%
  Val class distribution:
    Low: 62.5%
    Medium: 2.9%
    High: 34.6%
  Test class distribution:
    Low: 61.6%
    Medium: 3.3%
    High: 35.1%
  ✓ Stratification successful

======================================================================
[FEATURES] Extracting Hybrid Features
======================================================================
Processing 7135 stories...

[1/2] Extracting symbolic features...
  Features: readability, text stats, risk keywords, linguistic patterns
